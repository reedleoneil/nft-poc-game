<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>


<div class="container">
    <div id="new-player-container" class="row hidden">
        <div class="col-12 text-center">
            <h1>Hello New Player!</h1>
        </div>

        <div class="col-4">
            <h3>Please Enter Player Name</h3>
            <input id="txt-player-name" type="text" class="form-control margin-lg-bottom" maxlength="20" />
            <button id="btn-save-player" class="btn btn-success">SAVE</button>
        </div>
    </div>

    <div id="saved-player-container" class="row hidden">
        <div class="col-12 text-center">
            <h1>Hello <span class="player-name"></span></h1>
        </div>

        <div class="col-12">
            <table class="table table-borderless">
                <thead>
                    <tr class="text-center">
                        <td><label>LEVEL</label></td>
                        <td><label>CARDS</label></td>
                        <td><label>ACTION</label></td>
                    </tr>
                </thead>
                <tbody>
                    <tr class="text-center">
                        <td><h2>1</h2></td>
                        <td>
                            <button id="btn-view-cards" class="btn btn-default">View</button>
                        </td>
                        <td>
                            <button id="btn-battle" class="btn btn-default">Battle!</button>
                            <button class="btn btn-default">PVP</button>
                            <button class="btn btn-default">Market</button>
                            <button class="btn btn-default">Battle Logs</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="cards-container" class="col-12 hidden">
            <table class="table table-borderless">
                <thead>
                    <tr class="col-12 text-center">
                        <td class="col-4"><label>CARD NAME</label></td>
                        <td class="col-8"><label>EFFECT</label></td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="text-center">
                            <h2>ATTACK</h2>
                            <img class="action" src="https://image.flaticon.com/icons/png/512/2746/2746914.png" />
                        </td>
                        <td>Deal 100 damage to enemy</td>
                    </tr>
                    <tr>
                        <td class="text-center">
                            <h2>DEFEND</h2>
                            <img class="action" src="https://image.flaticon.com/icons/png/512/46/46887.png" />
                        </td>
                        <td>Block 80 damage from enemy. Only blocks 30 damage when enemy uses Brute Force</td>
                    </tr>
                    <tr>
                        <td class="text-center">
                            <h2>HEAL</h2>
                            <img class="action" src="https://image.flaticon.com/icons/png/512/2696/2696455.png" />
                        </td>
                        <td>Recover 60 HP</td>
                    </tr>
                    <tr>
                        <td class="text-center">
                            <h2>BRUTE FORCE</h2>
                            <img class="action" src="https://image.flaticon.com/icons/png/512/514/514143.png" />
                        </td>
                        <td>Deal 100 damage to enemy. Deduct 20 HP to self after.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div id="battle-container" class="row hidden">
        <div class="col-12">
            <table class="table table-borderless">
                <tr class="col-12">
                    <td class="col-5 text-center">
                        <h2 class="player-name"></h2>
                        <div class="progress margin-md-bottom">
                            <div id="player-hp" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="1000"
                                 aria-valuemin="0" aria-valuemax="1000" style="width:100%">
                                1000/1000
                            </div>
                        </div>
                        <img src="https://static.thenounproject.com/png/1849760-200.png" />
                    </td>
                    <td class="col-2 text-center"><h1>VS.</h1></td>
                    <td class="col-5 text-center">
                        <h2>Fluff Monster</h2>
                        <div class="progress margin-md-bottom">
                            <div id="enemy-hp" class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="1000"
                                 aria-valuemin="0" aria-valuemax="1000" style="width:100%">
                                1000/1000
                            </div>
                        </div>
                        <img src="https://static.thenounproject.com/png/1849753-200.png" />
                    </td>
                </tr>
            </table>

            <table class="table table-borderless">
                <tr class="row text-center">
                    <td class="col-4">
                        <h2>First Move</h2>
                        <img id="first-move" class="action card-moves" src="https://image.flaticon.com/icons/png/512/2997/2997933.png" />
                    </td>
                    <td class="col-4">
                        <h2>Second Move</h2>
                        <img id="second-move" class="action card-moves" src="https://image.flaticon.com/icons/png/512/2997/2997933.png" />
                    </td>
                    <td class="col-4">
                        <h2>Last Move</h2>
                        <img id="last-move" class="action card-moves" src="https://image.flaticon.com/icons/png/512/2997/2997933.png" />
                    </td>
                </tr>
                <tr id="proceed-battle-container" class="hidden text-center">
                    <td colspan="4">
                        <button id="btn-confirm" class="btn btn-primary">Proceed Battle!</button>
                    </td>
                </tr>
            </table>

            <table class="table table-borderless">
                <tr class="row text-center">
                    <td class="col-12" id="hand-cards-container"></td>
                </tr>
                <tr>
                    <td id="battle-logs-container" colspan="3"></td>
                </tr>
            </table>
        </div>
    </div>
</div>

<style>
    .body-content {
        padding-top: 0px;
    }

    button.action {
        margin: 10px;
    }

        button.action img {
            height: 120px;
            width: 120px;
        }

    .action {
        height: 150px;
        width: 150px;
    }

    .progress {
        height: 20px;
        font-size: 18px;
    }

    .progress-bar-success {
        background-color: #5cb85c;
    }

    .progress-bar-warning {
        background-color: #f0ad4e;
    }

    .progress-bar-danger {
        background-color: #d9534f;
    }
</style>

<script>
    var module = {
        battleLogs: "",
        currentRound: 1,
        maxHP: 1000,
        attachEvents: function () {
            $("#btn-battle").on("click", module.onBattle);
            $("#btn-save-player").on("click", module.onSavePlayer);
            $("#btn-view-cards").on("click", module.onViewCards);
            $("body").delegate("button.action", "click", module.onSelectAction);
            $("#btn-confirm").on("click", module.onConfirmBattle);
        },
        addEditProfile: function (data) {
            localStorage.setItem("Profile", JSON.stringify(data));
        },
        addHP: function (currentHP, heal) {
            if ((currentHP + heal) > module.maxHP)
                return module.maxHP;
            else
                return currentHP + heal;
        },
        checkIfBattleReady: function () {
            if ($("img[src='" + module.getIcons().Add + "']").length == 0) {
                $("#proceed-battle-container").removeClass("hidden");
            }
            else {
                $("#proceed-battle-container").addClass("hidden");
            }
        },
        checkWinner: function (movePosition, data) {
            var profile = module.getProfile();

            if (profile.PlayerHP <= 0 && profile.EnemyHP <= 0) {
                alert("Draw!");
                module.showRoundBattleLog("Draw");
            }
            else if (profile.EnemyHP <= 0) {
                alert("You Win!");
                module.showRoundBattleLog("Win");
            }
            else if (profile.PlayerHP <= 0) {
                alert("You Lose!");
                module.showRoundBattleLog("Lose");
            }
            else {
                movePosition++;

                if (movePosition <= 3)
                    module.getMoveResult(movePosition, data);
                else
                    module.showRoundBattleLog();
            }
        },
        gameRound: function (round) {
            $(".card-moves").attr("src", module.getIcons().Add)
                .removeAttr("title");

            $("#proceed-battle-container").addClass("hidden");

            var profile = module.getProfile();
            var cardDrawCount = 5 - profile.PlayerHands.length;

            if (profile.PlayerCards.length > 0 && profile.PlayerCards.length < 3) {
                var playerCardsCount = 3 - profile.PlayerCards.length;
                for (var i = 0; i < playerCardsCount; i++) {
                    var ownRandom = Math.floor(Math.random() * profile.PlayerUsedCards.length);
                    var enemyRandom = Math.floor(Math.random() * profile.EnemyUsedCards.length);

                    profile.PlayerHands.push(profile.PlayerUsedCards[ownRandom]);
                    profile.EnemyHands.push(profile.EnemyUsedCards[enemyRandom]);

                    profile.PlayerUsedCards.splice(ownRandom, 1);
                    profile.EnemyUsedCards.splice(enemyRandom, 1);

                    module.addEditProfile(profile);
                }
            }
            else if (profile.PlayerCards.length == 0) {
                profile.PlayerCards = profile.PlayerUsedCards;
                profile.PlayerUsedCards = [];

                profile.EnemyCards = profile.EnemyUsedCards;
                profile.EnemyUsedCards = [];

                module.addEditProfile(profile);
            }

            for (var i = 0; i < cardDrawCount; i++) {
                profile = module.getProfile();

                if (profile.PlayerCards.length != 0) {
                    var ownRandom = Math.floor(Math.random() * profile.PlayerCards.length);
                    var enemyRandom = Math.floor(Math.random() * profile.EnemyCards.length);

                    profile.PlayerHands.push(profile.PlayerCards[ownRandom]);
                    profile.EnemyHands.push(profile.EnemyCards[enemyRandom]);

                    profile.PlayerCards.splice(ownRandom, 1);
                    profile.EnemyCards.splice(enemyRandom, 1);

                    module.addEditProfile(profile);
                }
            }

            module.setOwnCards();
        },
        getPlayerBattleLog: function (playerMove, enemyMove, profile) {
            var battleLog = "";

            if (playerMove == "Attack") {
                if (enemyMove == "Attack") {
                    battleLog += "You dealt <label class='text-danger'>100</label> damage using <label>ATTACK</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>100</label> damage from <label>ATTACK (" + profile.PlayerHP + ")</label>.<br/>";

                    battleLog += "Enemy dealt <label class='text-danger'>100</label> damage using <label>ATTACK</label>.<br/>";
                    battleLog += "Enemy took <label class='text-danger'>100</label> damage from <label>ATTACK (" + profile.EnemyHP + ")</label>.<br/>";
                }

                if (enemyMove == "Defend") {
                    battleLog += "You dealt <label class='text-danger'>20</label> damage using <label>ATTACK</label>.<br/>";

                    battleLog += "Enemy took <label class='text-danger'>20</label> damage from <label>ATTACK (" + profile.EnemyHP + ")</label>.<br/>";
                    battleLog += "Enemy blocked <label class='text-info'>80</label> damage using <label>DEFEND</label>.<br/>";
                }

                if (enemyMove == "Heal") {
                    battleLog += "You dealt <label class='text-danger'>100</label> damage using <label>ATTACK</label>.<br/>";

                    battleLog += "Enemy took <label class='text-danger'>100</label> damage from <label>ATTACK (" + (profile.EnemyHP - 60) + ")</label>.<br/>";
                    battleLog += "Enemy restored <label class='text-success'>60</label> HP using <label>HEAL (" + profile.EnemyHP + ")</label>.<br/>";
                }

                if (enemyMove == "Brute Force") {
                    battleLog += "You dealt <label class='text-danger'>100</label> damage using <label>ATTACK</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>100</label> damage from <label>BRUTE FORCE (" + profile.PlayerHP + ")</label>.<br/>";

                    battleLog += "Enemy dealt <label class='text-danger'>100</label> damage using <label>BRUTE FORCE</label>.<br/>";
                    battleLog += "Enemy took <label class='text-danger'>100</label> damage from <label>ATTACK (" + (profile.EnemyHP + 20) + ")</label>.<br/>";
                    battleLog += "Enemy took <label class='text-danger'>20</label> damage from <label>BRUTE FORCE effect (" + profile.EnemyHP + ")</label>.<br/>";
                }
            }

            if (playerMove == "Defend") {
                if (enemyMove == "Attack") {
                    battleLog += "You blocked <label class='text-info'>80</label> damage using <label>DEFEND</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>20</label> damage from <label>ATTACK (" + profile.PlayerHP + ")</label>.<br/>";

                    battleLog += "Enemy dealt <label class='text-danger'>20</label> damage using <label>ATTACK</label>.<br/>";
                }

                if (enemyMove == "Defend") {
                    battleLog += "You used <label>DEFEND</label> to block incoming <label class='text-info'>80</label> damage.<br/>";

                    battleLog += "Enemy used <label>DEFEND</label> to block incoming <label class='text-info'>80</label> damage.<br/>";
                }

                if (enemyMove == "Heal") {
                    battleLog += "You used <label>DEFEND</label> to block incoming <label class='text-info'>80</label> damage.<br/>";

                    battleLog += "Enemy restored <label class='text-success'>60</label> HP using <label>HEAL (" + profile.EnemyHP + ")</label>.<br/>";
                }

                if (enemyMove == "Brute Force") {
                    battleLog += "You took <label class='text-danger'>70</label> damage from <label>BRUTE FORCE (" + profile.PlayerHP + ")</label>.<br/>";
                    battleLog += "You blocked <label class='text-info'>30</label> damage using <label>DEFEND</label>.<br/>";

                    battleLog += "Enemy dealt <label class='text-danger'>70</label> damage using <label>BRUTE FORCE</label>.<br/>";
                    battleLog += "Enemy took <label class='text-danger'>20</label> damage from <label>BRUTE FORCE effect (" + profile.EnemyHP + ")</label>.<br/>";
                }
            }

            if (playerMove == "Heal") {
                if (enemyMove == "Attack") {
                    battleLog += "You restored <label class='text-success'>60</label> HP using <label>HEAL (" + (profile.PlayerHP - 100) + ")</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>100</label> damage from <label>ATTACK (" + profile.PlayerHP + ")</label>.<br/>";

                    battleLog += "Enemy dealt <label class='text-danger'>100</label> damage using <label>ATTACK</label>.<br/>";
                }

                if (enemyMove == "Defend") {
                    battleLog += "You restored <label class='text-success'>60</label> HP using <label>HEAL (" + profile.PlayerHP + ")</label>.<br/>";

                    battleLog += "Enemy used <label>DEFEND</label> to block incoming <label class='text-info'>80</label> damage.<br/>";
                }

                if (enemyMove == "Heal") {
                    battleLog += "You restored <label class='text-success'>60</label> HP using <label>HEAL (" + profile.PlayerHP + ")</label>.<br/>";

                    battleLog += "Enemy restored <label class='text-success'>60</label> HP using <label>HEAL (" + profile.EnemyHP + ")</label>.<br/>";
                }

                if (enemyMove == "Brute Force") {
                    battleLog += "You restored <label class='text-success'>60</label> HP using <label>HEAL (" + (profile.PlayerHP - 100) + ")</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>100</label> damage from <label>BRUTE FORCE (" + (profile.PlayerHP - 100) + ")</label>.<br/>";

                    battleLog += "Enemy dealt <label class='text-danger'>100</label> damage using <label>BRUTE FORCE</label>.<br/>";
                    battleLog += "Enemy took <label class='text-danger'>20</label> damage from <label>BRUTE FORCE effect (" + profile.EnemyHP + ")</label>.<br/>";
                }
            }

            if (playerMove == "Brute Force") {
                if (enemyMove == "Attack") {
                    battleLog += "You dealt <label class='text-danger'>100</label> damage using <label>BRUTE FORCE</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>100</label> damage from <label>ATTACK (" + (profile.PlayerHP + 20) + ")</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>20</label> damage from <label>BRUTE FORCE effect (" + profile.PlayerHP + ")</label>.<br/>";

                    battleLog += "Enemy dealt <label class='text-danger'>100</label> damage using <label>ATTACK</label>.<br/>";
                    battleLog += "Enemy took <label class='text-danger'>100</label> damage from <label>BRUTE FORCE (" + profile.EnemyHP + ")</label>.<br/>";
                }

                if (enemyMove == "Defend") {
                    battleLog += "You dealt <label class='text-danger'>70</label> damage using <label>BRUTE FORCE</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>20</label> damage from <label>BRUTE FORCE effect (" + profile.PlayerHP + ")</label>.<br/>";

                    battleLog += "Enemy blocked <label class='text-info'>30</label> damage using <label>DEFEND</label>.<br/>";
                    battleLog += "Enemy took <label class='text-danger'>70</label> damage from <label>BRUTE FORCE (" + profile.EnemyHP + ")</label>.<br/>";
                }

                if (enemyMove == "Heal") {
                    battleLog += "You dealt <label class='text-danger'>100</label> damage using <label>BRUTE FORCE</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>20</label> damage from <label>BRUTE FORCE effect (" + profile.PlayerHP + ")</label>.<br/>";

                    battleLog += "Enemy took <label class='text-danger'>100</label> damage from <label>BRUTE FORCE (" + (profile.EnemyHP - 60) + ")</label>.<br/>";
                    battleLog += "Enemy restored <label class='text-success'>60</label> HP using <label>HEAL (" + profile.EnemyHP + ")</label>.<br/>";
                }

                if (enemyMove == "Brute Force") {
                    battleLog += "You dealt <label class='text-danger'>100</label> damage using <label>BRUTE FORCE</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>100</label> damage from <label>BRUTE FORCE (" + (profile.PlayerHP + 20) + ")</label>.<br/>";
                    battleLog += "You took <label class='text-danger'>20</label> damage from <label>BRUTE FORCE effect (" + profile.PlayerHP + ")</label>.<br/>";

                    battleLog += "Enemy dealt <label class='text-danger'>100</label> damage using <label>BRUTE FORCE</label>.<br/>";
                    battleLog += "Enemy took <label class='text-danger'>100</label> damage from <label>BRUTE FORCE (" + (profile.EnemyHP + 20) + ")</label>.<br/>";
                    battleLog += "Enemy took <label class='text-danger'>20</label> damage from <label>BRUTE FORCE effect (" + profile.EnemyHP + ")</label>.<br/>";
                }
            }

            battleLog += "<br/>";

            return battleLog;
        },
        getIcons: function () {
            return {
                Attack: "https://image.flaticon.com/icons/png/512/2746/2746914.png",
                Defend: "https://image.flaticon.com/icons/png/512/46/46887.png",
                Heal: "https://image.flaticon.com/icons/png/512/2696/2696455.png",
                BruteForce: "https://image.flaticon.com/icons/png/512/514/514143.png",
                Add: "https://image.flaticon.com/icons/png/512/2997/2997933.png",
                Undo: "https://image.flaticon.com/icons/png/512/2350/2350172.png"
            };
        },
        getProfile: function () {
            return JSON.parse(localStorage.getItem("Profile"));
        },
        getMoveResult: function (movePosition, data) {
            var playerMove = "";
            var enemyMove = "";
            switch (movePosition) {
                case 1:
                    playerMove = $("#first-move").attr("title");
                    enemyMove = data[0];
                    module.battleLogs += "<strong>First Move:</strong> ";
                    break;
                case 2:
                    playerMove = $("#second-move").attr("title");
                    enemyMove = data[1];
                    module.battleLogs += "<strong>Second Move:</strong> ";
                    break;
                case 3:
                    playerMove = $("#last-move").attr("title");
                    enemyMove = data[2];
                    module.battleLogs += "<strong>Last Move:</strong> ";
                    break;
            }

            module.battleLogs += "You used <strong>" + playerMove.toUpperCase() + "</strong>. Enemy used <strong>" + enemyMove.toUpperCase() + "</strong>.<br/>";

            var profile = module.getProfile();

            if (playerMove == "Attack") {
                if (enemyMove == "Attack") {
                    profile.PlayerHP -= 100;
                    profile.EnemyHP -= 100;
                }
                else if (enemyMove == "Defend") {
                    profile.EnemyHP -= 20;
                }
                else if (enemyMove == "Heal") {
                    if (profile.EnemyHP <= 100) {
                        profile.EnemyHP = module.addHP(profile.EnemyHP, 60);
                        profile.EnemyHP -= 100;
                    }
                    else {
                        profile.EnemyHP -= 100;
                        profile.EnemyHP = module.addHP(profile.EnemyHP, 60);
                    }
                }
                else if (enemyMove == "Brute Force") {
                    profile.PlayerHP -= 100;
                    profile.EnemyHP -= 100;

                    profile.EnemyHP -= 20;
                }
            }
            else if (playerMove == "Defend") {
                if (enemyMove == "Attack") {
                    profile.PlayerHP -= 20;
                }
                else if (enemyMove == "Defend") {
                    profile.PlayerHP -= 0;
                    profile.EnemyHP -= 0;
                }
                else if (enemyMove == "Heal") {
                    profile.EnemyHP = module.addHP(profile.EnemyHP, 60);
                }
                else if (enemyMove == "Brute Force") {
                    profile.PlayerHP -= 70;
                    profile.EnemyHP -= 20;
                }
            }
            else if (playerMove == "Heal") {
                if (enemyMove == "Attack") {
                    if (profile.PlayerHP <= 100) {
                        profile.PlayerHP = module.addHP(profile.PlayerHP, 60);
                        profile.PlayerHP -= 100;
                    }
                    else {
                        profile.PlayerHP -= 100;
                        profile.PlayerHP = module.addHP(profile.PlayerHP, 60);
                    }
                }
                else if (enemyMove == "Defend") {
                    profile.PlayerHP = module.addHP(profile.PlayerHP, 60);
                }
                else if (enemyMove == "Heal") {
                    profile.PlayerHP = module.addHP(profile.PlayerHP, 60);
                    profile.EnemyHP = module.addHP(profile.EnemyHP, 60);
                }
                else if (enemyMove == "Brute Force") {
                    if (profile.PlayerHP <= 100) {
                        profile.PlayerHP = module.addHP(profile.PlayerHP, 60);
                        profile.PlayerHP -= 100;
                    }
                    else {
                        profile.PlayerHP -= 100;
                        profile.PlayerHP = module.addHP(profile.PlayerHP, 60);
                    }

                    profile.EnemyHP -= 20;
                }
            }
            else if (playerMove == "Brute Force") {
                if (enemyMove == "Attack") {
                    profile.PlayerHP -= 100;
                    profile.EnemyHP -= 100;

                    profile.PlayerHP -= 20;
                }
                else if (enemyMove == "Defend") {
                    profile.PlayerHP -= 20;
                    profile.EnemyHP -= 70;
                }
                else if (enemyMove == "Heal") {
                    if (profile.EnemyHP <= 100) {
                        profile.EnemyHP = module.addHP(profile.EnemyHP, 60);
                        profile.EnemyHP -= 100;
                    }
                    else {
                        profile.EnemyHP -= 100;
                        profile.EnemyHP = module.addHP(profile.EnemyHP, 60);
                    }

                    profile.PlayerHP -= 20;
                }
                else if (enemyMove == "Brute Force") {
                    profile.PlayerHP -= 100;
                    profile.EnemyHP -= 100;

                    profile.PlayerHP -= 20;
                    profile.EnemyHP -= 20;
                }
            }

            module.battleLogs += module.getPlayerBattleLog(playerMove, enemyMove, profile);

            module.addEditProfile(profile);

            module.updateHPBars();

            module.checkWinner(movePosition, data);
        },
        onLoad: function () {
            module.attachEvents();

            if (module.getProfile()) {
                $(".player-name").text(module.getProfile().Name);
                $("#saved-player-container").removeClass("hidden");
            }
            else {
                $("#new-player-container").removeClass("hidden");
            }
        },
        onBattle: function () {
            $("#saved-player-container").addClass("hidden");
            $("#battle-container").removeClass("hidden");

            var profile = module.getProfile();

            var playerCards = [];
            var enemyCards = [];
            for (var i = 0; i < 4; i++) {
                playerCards.push("Attack");
                playerCards.push("Defend");
                playerCards.push("Heal");
                playerCards.push("Brute Force");

                enemyCards.push("Attack");
                enemyCards.push("Defend");
                enemyCards.push("Heal");
                enemyCards.push("Brute Force");
            }

            profile.PlayerHP = module.maxHP;
            profile.EnemyHP = module.maxHP;
            profile.PlayerCards = playerCards;
            profile.EnemyCards = enemyCards;
            profile.PlayerHands = [];
            profile.EnemyHands = [];
            profile.PlayerUsedCards = [];
            profile.EnemyUsedCards = [];

            module.addEditProfile(profile);

            module.gameRound(module.currentRound);
        },
        onConfirmBattle: function () {
            var profile = module.getProfile();

            var firstMove = $("#first-move").attr("title");
            var secondMove = $("#second-move").attr("title");
            var lastMove = $("#last-move").attr("title");

            profile.PlayerHands.splice(profile.PlayerHands.indexOf(firstMove), 1);
            profile.PlayerHands.splice(profile.PlayerHands.indexOf(secondMove), 1);
            profile.PlayerHands.splice(profile.PlayerHands.indexOf(lastMove), 1);

            profile.PlayerUsedCards.push(firstMove);
            profile.PlayerUsedCards.push(secondMove);
            profile.PlayerUsedCards.push(lastMove);

            var enemyActions = [];
            for (var i = 0; i < 3; i++) {
                var enemyRandom = Math.floor(Math.random() * profile.EnemyHands.length);

                enemyActions.push(profile.EnemyHands[enemyRandom]);
                profile.EnemyUsedCards.push(profile.EnemyHands[enemyRandom]);

                profile.EnemyHands.splice(enemyRandom, 1);

                module.addEditProfile(profile);
            }

            module.battleLogs += "<h3>Round " + module.currentRound + "</h3>";
            module.getMoveResult(1, enemyActions);
        },
        onSavePlayer: function () {
            module.addEditProfile({ Name: $("#txt-player-name").val() });
            $("#new-player-container").addClass("hidden");

            $(".player-name").text(module.getProfile().Name);
            $("#saved-player-container").removeClass("hidden");
        },
        onSelectAction: function () {
            var action = $(this).attr("title"),
                icons = module.getIcons(),
                src = "";

            switch (action) {
                case "Attack": src = icons.Attack;
                    break;
                case "Defend": src = icons.Defend;
                    break;
                case "Heal": src = icons.Heal;
                    break;
                case "Brute Force": src = icons.BruteForce;
                    break;
            }

            if ($("#first-move").attr("src") == icons.Add
                && action != "Undo") {
                $("#first-move").attr("src", src)
                    .attr("title", action);

                $(this).find("img").attr("src", icons.Undo);

                $(this).attr("title", "Undo")
                    .attr("position", "first");
            }
            else if ($("#second-move").attr("src") == icons.Add
                && action != "Undo") {
                $("#second-move").attr("src", src)
                    .attr("title", action);

                $(this).find("img").attr("src", icons.Undo);

                $(this).attr("title", "Undo")
                    .attr("position", "second");
            }
            else if ($("#last-move").attr("src") == icons.Add
                && action != "Undo") {
                $("#last-move").attr("src", src)
                    .attr("title", action);

                $(this).find("img").attr("src", icons.Undo);

                $(this).attr("title", "Undo")
                    .attr("position", "last");
            }
            else if (action == "Undo") {
                var position = $(this).attr("position");

                if (position == "first") {
                    $(this).find("img").attr("src", $("#first-move").attr("src"));

                    $("#first-move").attr("src", icons.Add);

                    $(this).attr("title", $("#first-move").attr("title"));
                    $("#first-move").removeAttr("title");
                }
                else if (position == "second") {
                    $(this).find("img").attr("src", $("#second-move").attr("src"));

                    $("#second-move").attr("src", icons.Add);

                    $(this).attr("title", $("#second-move").attr("title"));
                    $("#second-move").removeAttr("title");
                }
                else {
                    $(this).find("img").attr("src", $("#last-move").attr("src"));

                    $("#last-move").attr("src", icons.Add);

                    $(this).attr("title", $("#last-move").attr("title"));
                    $("#last-move").removeAttr("title");
                }

                $(this).removeAttr("position");
            }

            module.checkIfBattleReady();
        },
        onViewCards: function () {
            if ($(this).text() == "View")
                $(this).text("Hide");
            else
                $(this).text("View");

            $("#cards-container").toggleClass("hidden");
        },
        setOwnCards: function () {
            $("#hand-cards-container").html("<h2>Loading Cards</h2>" +
                "<div class='progress'>" +
                "<div id='progress-hand-cards' class='progress-bar progress-bar-info' role='progressbar' aria-valuenow='0'" +
                "aria-valuemin='0' aria-valuemax='100' style='width:0%'>" +
                "</div>" +
                "</div>");

            var icons = module.getIcons();
            var ownCards = module.getProfile().PlayerHands;
            var template = "<h2>Action Cards</h2>";

            for (var i = 0; i < ownCards.length; i++) {
                switch (ownCards[i]) {
                    case "Attack": template += "<button title='Attack' class='action'><img src='" + icons.Attack + "' /></button>";
                        break;
                    case "Defend": template += "<button title='Defend' class='action'><img src='" + icons.Defend + "' /></button>";
                        break;
                    case "Heal": template += "<button title='Heal' class='action'><img src='" + icons.Heal + "' /></button>";
                        break;
                    case "Brute Force": template += "<button title='Brute Force' class='action'><img src='" + icons.BruteForce + "' /></button>";
                        break;
                    default:
                }
            }

            var count = 0;
            var interval = setInterval(function () {
                count++;

                $("#progress-hand-cards").attr("aria-valuenow", count * 50);
                $("#progress-hand-cards").css("width", count * 50 + "%");

                if (count == 3) {
                    $("#hand-cards-container").html(template);
                    clearInterval(interval);
                }
            }, 1000);
        },
        showRoundBattleLog: function (result) {
            if (result) {
                if (result == "Win") {
                    module.battleLogs += "<label class='text-success'><h2>You Win!</h2></label>";
                }
                else if (result == "Lose") {
                    module.battleLogs += "<label class='text-danger'><h2>You Lose!</h2></label>";
                }
                else {
                    module.battleLogs += "<label class='text-info'><h2>Draw!</h2></label>";
                }

                $("#proceed-battle-container").addClass("hidden");
            }

            $("#battle-logs-container").prepend(module.battleLogs);
            module.battleLogs = "";

            if (!result) {
                module.currentRound++;

                module.gameRound(module.currentRound);
            }
        },
        updateHPBars: function () {
            var profile = module.getProfile();

            var playerHPPctg = ((profile.PlayerHP / module.maxHP) * 100);
            var enemyHPPctg = ((profile.EnemyHP / module.maxHP) * 100);

            $("#player-hp").attr("aria-valuenow", profile.PlayerHP)
                .css("width", playerHPPctg + "%")
                .html(profile.PlayerHP + "/" + module.maxHP);

            $("#enemy-hp").attr("aria-valuenow", profile.EnemyHP)
                .css("width", enemyHPPctg + "%")
                .html(profile.EnemyHP + "/" + + module.maxHP);;

            if (playerHPPctg <= 50 && playerHPPctg > 30) {
                $("#player-hp").removeClass("progress-bar-success")
                    .addClass("progress-bar-warning");
            }
            else if (playerHPPctg <= 30) {
                $("#player-hp").removeClass("progress-bar-warning")
                    .addClass("progress-bar-danger");
            }

            if (enemyHPPctg <= 50 && enemyHPPctg > 30) {
                $("#enemy-hp").removeClass("progress-bar-success")
                    .addClass("progress-bar-warning");
            }
            else if (enemyHPPctg <= 30) {
                $("#enemy-hp").removeClass("progress-bar-warning")
                    .addClass("progress-bar-danger");
            }
        }
    };

    $(window).on("load", module.onLoad);
</script>
